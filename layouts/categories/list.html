{{- define "main" }}

{{- if not .IsHome }}
<header class="page-header">
  <h1>分类</h1>
</header>
{{- end }}

{{- if .Content }}
<div class="post-content">
  {{- if not (.Param "disableAnchoredHeadings") }}
  {{- partial "anchored_headings.html" .Content -}}
  {{- else }}{{ .Content }}{{ end }}
</div>
{{- end }}

{{- $categories := .Data.Terms.ByCount }}
{{- if $categories }}
<div class="categories-elegant-grid">
  {{- range $name, $taxonomy := $categories }}
  <article class="category-elegant-card">
    <div class="category-elegant-header">
      <div class="category-title-section">
        <h3 class="category-elegant-name">
          <a href="{{ .Page.Permalink }}">{{ .Page.Title }}</a>
        </h3>
        <div class="category-meta">
          <span class="category-count">{{ .Count }} 篇文章</span>
          <span class="category-separator">•</span>
          <span class="category-recent">最近更新</span>
        </div>
      </div>
      <div class="category-accent-line"></div>
    </div>
    
    <div class="category-elegant-preview">
      {{- $recentPosts := first 3 .Pages.ByDate.Reverse }}
      {{- range $index, $post := $recentPosts }}
      <div class="category-elegant-post">
        <a href="{{ .Permalink }}" class="category-elegant-link">
          <div class="post-title-section">
            <h4 class="post-elegant-title">{{ .Title }}</h4>
            <div class="post-meta-line">
              <time class="post-date">{{ .Date.Format "01月02日" }}</time>
              {{- if .Params.tags }}
              <span class="post-tags">
                {{- range first 2 .Params.tags }}
                <span class="post-tag">#{{ . }}</span>
                {{- end }}
              </span>
              {{- end }}
            </div>
          </div>
        </a>
      </div>
      {{- end }}
      
      {{- if gt .Count 3 }}
      <div class="category-elegant-more">
        <a href="{{ .Page.Permalink }}" class="category-elegant-more-link">
          <span>查看全部 {{ .Count }} 篇文章</span>
          <svg class="arrow-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </a>
      </div>
      {{- end }}
    </div>
  </article>
  {{- end }}
</div>

<style>
.categories-elegant-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
  gap: 2rem;
  margin-top: 2rem;
}

.category-elegant-card {
  background: var(--theme);
  border: 1px solid var(--border);
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  position: relative;
}

.category-elegant-card:hover {
  border-color: var(--tertiary);
  box-shadow: 0 8px 24px rgba(0,0,0,0.08);
  transform: translateY(-2px);
}

.category-elegant-header {
  padding: 1.5rem 2rem 1rem;
  position: relative;
}

.category-title-section {
  margin-bottom: 0.75rem;
}

.category-elegant-name {
  margin: 0 0 0.5rem 0;
  font-size: 1.25rem;
  font-weight: 600;
  line-height: 1.3;
}

.category-elegant-name a {
  color: var(--primary);
  text-decoration: none;
  transition: color 0.2s ease;
}

.category-elegant-name a:hover {
  color: var(--tertiary);
}

.category-meta {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.875rem;
  color: var(--secondary);
}

.category-count {
  font-weight: 500;
  color: var(--tertiary);
}

.category-separator {
  opacity: 0.6;
}

.category-accent-line {
  height: 2px;
  background: linear-gradient(90deg, var(--tertiary) 0%, transparent 100%);
  border-radius: 1px;
  margin-top: 0.5rem;
}

.category-elegant-preview {
  padding: 0 2rem 1.5rem;
}

.category-elegant-post {
  padding: 0.75rem 0;
  border-bottom: 1px solid var(--border);
}

.category-elegant-post:last-of-type {
  border-bottom: none;
}

.category-elegant-link {
  text-decoration: none;
  display: block;
  transition: all 0.2s ease;
}

.category-elegant-link:hover .post-elegant-title {
  color: var(--tertiary);
}

.post-title-section {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.post-elegant-title {
  margin: 0;
  font-size: 0.95rem;
  font-weight: 500;
  line-height: 1.4;
  color: var(--primary);
  transition: color 0.2s ease;
}

.post-meta-line {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  font-size: 0.8rem;
  color: var(--secondary);
}

.post-date {
  font-weight: 400;
}

.post-tags {
  display: flex;
  gap: 0.5rem;
}

.post-tag {
  background: var(--code-bg);
  padding: 0.125rem 0.375rem;
  border-radius: 4px;
  font-size: 0.75rem;
  color: var(--secondary);
  transition: all 0.2s ease;
}

.category-elegant-more {
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid var(--border);
}

.category-elegant-more-link {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.5rem 0;
  color: var(--tertiary);
  text-decoration: none;
  font-size: 0.875rem;
  font-weight: 500;
  transition: all 0.2s ease;
}

.category-elegant-more-link:hover {
  color: var(--primary);
}

.arrow-icon {
  transition: transform 0.2s ease;
  opacity: 0.7;
}

.category-elegant-more-link:hover .arrow-icon {
  transform: translateX(2px);
  opacity: 1;
}

@media (max-width: 768px) {
  .categories-elegant-grid {
    grid-template-columns: 1fr;
    gap: 1.5rem;
  }
  
  .category-elegant-header,
  .category-elegant-preview {
    padding-left: 1.5rem;
    padding-right: 1.5rem;
  }
  
  .post-meta-line {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.25rem;
  }
}
</style>
{{- end }}

{{- end }}{{- /* end main */ -}}